const name=document.getElementById('name'),description=document.getElementById('description'),currentpass=document.getElementById('currentpass'),newpass=document.getElementById('newpass'),confirmpass=document.getElementById('confirmpass'),currentpassMsg=document.getElementById('currentpassmsg'),confirmpassMsg=document.getElementById('confirmpassmsg'),passChangeForm=document.getElementById('pass-change'),changePassBtn=document.getElementById('changepass-btn'),password=document.getElementById('password'),passwordMsg=document.getElementById('password-msg'),yes=document.getElementById('yes'),no=document.getElementById('no'),removeAccountBtn=document.getElementById('remove-account-btn'),removeAccountForm=document.getElementById('remove-account-form');async function getUserJson(){const a=window.location.pathname.split('/'),b=`/${a[1]}/${a[2]}/userJson`;try{const c=await fetch(b,{headers:new Headers({'Content-Type':'application/json'}),method:'get'}),d=await c.json();d&&(name.value=d.name,description.value=d.description)}catch(c){console.log(c)}}getUserJson(),passChangeForm.addEventListener('submit',async function(a){a.preventDefault();const b=window.location.pathname.split('/'),c=`/${b[1]}/${b[2]}/changepassword`,d=`/${b[1]}/${b[2]}`;currentpass.className='validate',currentpassMsg.attributes[1].value='',confirmpass.className='validate',confirmpassMsg.attributes[1].nodeValue='',changePassBtn.classList.add('disabled');try{const f=await fetch(c,{headers:new Headers({'Content-Type':'application/json'}),credentials:'same-origin',method:'post',body:JSON.stringify({currentpass:currentpass.value,newpass:newpass.value,confirmpass:confirmpass.value})}),g=await f.json();g&&('C'===g.message[0]?(currentpass.className='validate invalid',currentpassMsg.attributes[1].nodeValue=g.message,changePassBtn.classList.remove('disabled')):'M'===g.message[0]?(confirmpass.className='validate invalid',confirmpassMsg.attributes[1].nodeValue=g.message,changePassBtn.classList.remove('disabled')):(password.className='validate valid',currentpass.className='validate valid',newpass.className='validate valid',Materialize.toast(g.message,3e3),setTimeout(()=>{location.href=d},3e3)))}catch(f){console.log(f)}}),removeAccountForm.addEventListener('submit',async function(a){a.preventDefault(),passwordMsg.attributes[1].nodeValue='',password.className='validate';const b=window.location.pathname.split('/'),c=`/${b[1]}/${b[2]}/check-pass`;try{const d=await fetch(c,{headers:new Headers({'Content-Type':'application/json'}),method:'post',credentials:'same-origin',body:JSON.stringify({password:password.value})}),f=await d.json();f&&(f.success?(removeAccountBtn.classList.add('disabled'),$('#modal').modal('open',{dismissible:!1}),removeAccountConfirmation()):(passwordMsg.attributes[1].nodeValue='Password does not match',password.className='validate invalid'))}catch(d){console.log(d)}});async function removeAccountConfirmation(){const a=window.location.pathname.split('/'),b=`/${a[1]}/${a[2]}/remove-account`;yes.addEventListener('click',async()=>{const c=await fetch(b,{headers:new Headers({'Content-Type':'application/json'}),method:'post',credentials:'same-origin'}),d=await c.json();d&&(Materialize.toast(d.message,3e3),setTimeout(()=>{location.href='/'},3e3))}),no.addEventListener('click',async()=>{$('#modal').modal('close'),location.href=document.referrer})}