<%- include header.ejs %>

<% if (session) { %>

<section class="main-section">
 <div class="container">
   <div class="row">
  <% if (user === undefined || user.active === false) { %>
    <h1>Sorry could not found user</h1>
     <% } else { %>
     <div class="col s4">
            <div class="card flex-center flex-column ta-center">
              <div class="pt-1">
                  <% if (user.profileImg.length > 0) { %>
                    <img src="/uploads/users/<%= user._id %>/<%= user.profileImg %>" class="circle responsive-img" />
                  <% } else { %>
                    <img src="/images/user-placeholder.png" />
                  <% } %>
                </div>
                <div class="card-content">
                <span class="card-title">
                  @<%= user.username %>
                  <img src="/images/flags/SE-32.png" />
                </span>
                <span class="card-title">
                  <%= user.name %>
                </span>
                <span class="card-subtitle">
                  Member since <%= user.registered.toDateString() %>
                </span>
                <br>
                  <span class="card-subtitle">
                    <a href="/users/<%= user._id %>/followers"><span id="followers"><%= followers %></span> follower(s)</a>
                </span>
                <div class="row">
                  <div class="col s6 ta-center">
                      <h6 class="tc-blue">CONTRIBUTIONS</h6>
                        <p class=""><%= user.reviews.length + user.ratings.length + user.consumes.length + user.images.length %></p>
                  </div>
                  <div class="col s6 ta-center">
                      <h6 class="tc-blue">RANK</h6>
                        <p class="" id="ranking-field"></p>
                  </div>
                     <% if (user.description) { %>
                  <p><%= user.description %></p>
                <% } else { %>
                  <p>User has no description yet.</p>
                <% } %>
                </div>
              </div>
              <div class="card-action flex-center flex-column">
                  <% if (session && session._id === user.id) { %>
                <a class="waves-effect waves-light btn" href="/users/<%= session._id %>/edit">Edit my profile</a>
                <% } else { %>
                  <% if (follower) { %>
                    <a class="waves-effect waves-light btn" id="follow" data-id="<%= user._id %>" href="">Unfollow</a>
                  <% } else { %>
                    <a class="waves-effect waves-light btn" id="follow" data-id="<%= user._id %>" href="">Follow</a>
                  <% } %>
               <% } %>
              </div>
          </div>
     </div>

 <div class="col s8">
   <div class="card">
     <ul class="collapsible" data-collapsible="accordion">
       <% if (user.reviews.length > 0) { %>
       <li>
         <div class="collapsible-header"><i class="material-icons">rate_review</i>Reviews</div>
         <div class="collapsible-body">
           <ul class="collection" id="reviews-container">
           </ul>
         </div>
       </li>
        <% } %>
       <li>
         <div class="collapsible-header"><i class="material-icons">star</i>Top Rated</div>
         <div class="collapsible-body"><span>Lorem ipsum dolor sit amet.</span></div>
       </li>
         <% if (user.images) { %>
       <li>
         <div class="collapsible-header"><i class="material-icons">collections</i>Gallery</div>
         <div class="collapsible-body">
           <div class="row">
             <% user.images.forEach(function(image) { %>
                  <div class="col s3">
                    <a href="/beers/<%= image.beer_id %>">
                      <img src="/uploads/beers/<%= image.beer_id %>/<%= image.name %>" class="responsive-img">
                    </a>
                  </div>
                  <% }); %>
           </div>
         </div>
       </li>
      <% } %>
    </ul>
  </div>
</div>
<% } %>
</div>
</div>
 </section> 

          

<% } %>
<%- include footer.ejs %>

<script src="/js/user.js"></script>

</body>
</html>